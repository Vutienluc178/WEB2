<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Form sinh Prompt: C√¥ng c·ª• h·ªçc t·∫≠p tr·ª±c quan To√°n</title>
<style>
  :root{
    --bg:#0b1020; --card:#111a33; --muted:#98a2b3; --txt:#eef2ff; --accent:#66e3ff; --border:#23305a;
    --ok:#22c55e; --warn:#f59e0b;
  }
  html,body{height:100%}
  body{
    margin:0; background:linear-gradient(180deg,#0b1020 0%,#0a0f1f 60%,#0a0e1b 100%);
    color:var(--txt); font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial;
  }
  .app{display:grid; grid-template-rows:auto 1fr auto; height:100%}
  header{
    padding:14px 18px; border-bottom:1px solid var(--border); background:#0b1226aa; backdrop-filter: blur(6px);
    display:flex; align-items:center; gap:12px;
  }
  header h1{font-size:18px; margin:0}
  header .badge{font-size:12px; padding:4px 8px; border:1px solid var(--border); border-radius:999px; color:var(--muted)}
  main{display:grid; grid-template-columns: 420px 1fr; gap:16px; padding:16px}
  @media(max-width:980px){ main{grid-template-columns: 1fr; } }
  .panel{
    background:var(--card); border:1px solid var(--border); border-radius:16px; padding:16px;
    box-shadow: 0 10px 30px rgba(0,0,0,.25);
  }
  .panel h2{margin:0 0 10px 0; font-size:16px}
  .row{display:grid; gap:8px; margin:12px 0}
  label{font-size:13px; color:var(--muted)}
  input[type="text"], textarea, select{
    width:100%; background:#0c1530; color:var(--txt); border:1px solid var(--border);
    border-radius:12px; padding:10px 12px; outline:none;
  }
  textarea{min-height:86px; resize:vertical; line-height:1.4}
  .hint{font-size:12px; color:var(--muted)}
  .grid-2{display:grid; grid-template-columns:1fr 1fr; gap:10px}
  .grid-3{display:grid; grid-template-columns:1fr 1fr 1fr; gap:10px}
  .toolbar{display:flex; gap:8px; flex-wrap:wrap; margin-top:8px}
  .btn{
    background:#0e1a3a; border:1px solid var(--border); color:var(--txt);
    padding:8px 12px; border-radius:10px; cursor:pointer; font-weight:600;
  }
  .btn:hover{border-color:#2f3f7a}
  .btn-accent{background:linear-gradient(90deg,#00e5ff,#38bdf8); color:#051225; border:none}
  .btn-ghost{background:transparent; border:1px dashed var(--border); color:var(--muted)}
  .stat{font-size:12px; color:var(--muted)}
  .preview{
    background:#0b142e; border:1px solid var(--border); border-radius:16px; padding:16px;
    display:grid; grid-template-rows: auto 1fr auto; min-height:420px;
  }
  .preview h3{margin:0 0 8px 0; font-size:16px}
  .codebox{
    background:#070d1e; border:1px solid #1b264a; border-radius:12px; padding:14px; overflow:auto;
    font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace; white-space:pre-wrap;
  }
  .preview .bar{display:flex; gap:8px; justify-content:flex-end; margin-top:12px}
  .pill{display:inline-block; padding:2px 8px; border-radius:999px; font-size:12px; background:#0d1a3a; border:1px solid var(--border); color:var(--muted)}
  footer{
    padding:12px 16px; border-top:1px solid var(--border); color:var(--muted); font-size:13px; text-align:center;
  }
  .ok{color:var(--ok)} .warn{color:var(--warn)}
  .kbd{font: 12px ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; background:#0c1634; border:1px solid var(--border); border-radius:6px; padding:2px 6px}
</style>
</head>
<body>
<div class="app">
  <header>
    <h1>üß© Form sinh Prompt ‚Äî C√¥ng c·ª• h·ªçc t·∫≠p tr·ª±c quan To√°n</h1>
    <span class="badge">T∆∞∆°ng t√°c ¬∑ Live Preview ¬∑ Auto-Save</span>
  </header>

  <main>
    <!-- LEFT: FORM -->
    <section class="panel" id="formPanel" aria-label="Form nh·∫≠p n·ªôi dung">
      <h2>üìù Th√¥ng tin ƒë·∫ßu v√†o</h2>

      <div class="row">
        <label>Ch·ªß ƒë·ªÅ to√°n h·ªçc c·ª• th·ªÉ</label>
        <input type="text" id="topic" placeholder="VD: Kh·∫£o s√°t s·ª± bi·∫øn thi√™n v√† v·∫Ω ƒë·ªì th·ªã h√†m s·ªë b·∫≠c ba">
        <div class="hint">M√¥ t·∫£ ng·∫Øn, r√µ kh√°i ni·ªám tr·ªçng t√¢m.</div>
      </div>

      <div class="row">
        <label>ƒê·ªëi t∆∞·ª£ng ng∆∞·ªùi h·ªçc</label>
        <select id="audience">
          <option>H·ªçc sinh THPT</option>
          <option>H·ªçc sinh l·ªõp 10</option>
          <option>H·ªçc sinh l·ªõp 11</option>
          <option>H·ªçc sinh l·ªõp 12</option>
          <option>Kh√°c (t·ª± ghi ·ªü m·ª•c Ghi ch√∫)</option>
        </select>
      </div>

      <div class="row">
        <label>M·ª•c ti√™u h·ªçc t·∫≠p c·ªët l√µi</label>
        <textarea id="goal" placeholder="VD: hi·ªÉu m·ªëi li√™n h·ªá tr·ª±c quan gi·ªØa d·∫•u c·ªßa y' v·ªõi ƒë·ªìng bi·∫øn/ngh·ªãch bi·∫øn v√† h√¨nh d·∫°ng ƒë·ªì th·ªã."></textarea>
        <div class="hint">Ch·ªâ 1‚Äì2 m·ª•c ti√™u ‚Äúxuy√™n su·ªët‚Äù gi√∫p AI t·∫≠p trung.</div>
      </div>

      <div class="row">
        <label>Kh√≥ khƒÉn c·ªët l√µi c·ªßa h·ªçc sinh</label>
        <textarea id="pain" placeholder="VD: kh√≥ h√¨nh dung v√¨ sao ƒë·ªì th·ªã ƒëi l√™n/ƒëi xu·ªëng v√† cong ·ªü nh·ªØng ƒëi·ªÉm c·ª• th·ªÉ."></textarea>
      </div>

      <div class="grid-2">
        <div class="row">
          <label>T∆∞∆°ng t√°c ch√≠nh #1</label>
          <textarea id="ix1" placeholder="VD: d√πng thanh tr∆∞·ª£t thay ƒë·ªïi h·ªá s·ªë a,b,c,d c·ªßa y = ax¬≥ + bx¬≤ + cx + d."></textarea>
        </div>
        <div class="row">
          <label>T∆∞∆°ng t√°c ch√≠nh #2</label>
          <textarea id="ix2" placeholder="VD: k√©o ƒëi·ªÉm tr√™n ƒë·ªì th·ªã ƒë·ªÉ xem ti·∫øp tuy·∫øn v√† gi√° tr·ªã ƒë·∫°o h√†m t·∫°i ƒëi·ªÉm ƒë√≥."></textarea>
        </div>
      </div>

      <div class="row">
        <label>Y√™u c·∫ßu tr·ª±c quan h√≥a (t√πy ch·ªânh, n·∫øu c·∫ßn)</label>
        <textarea id="viz" placeholder="M·∫∑c ƒë·ªãnh: hi·ªÉn th·ªã ƒë·ªì th·ªã C, ƒë·ªì th·ªã y', b·∫£ng bi·∫øn thi√™n, t√¥ m√†u ƒë·ªìng/ngh·ªãch bi·∫øn, ƒë√°nh d·∫•u c·ª±c tr·ªã."></textarea>
        <div class="hint">ƒê·ªÉ tr·ªëng n·∫øu d√πng m·∫∑c ƒë·ªãnh nh∆∞ m√¥ t·∫£ trong ƒë·ªÅ.</div>
      </div>

      <div class="row">
        <label>ƒê·∫∑t t√™n g·ªçi c√¥ng c·ª• (g·ª£i nh·ªõ & th√∫ v·ªã)</label>
        <input type="text" id="toolName" placeholder="VD: Cubic Explorer ¬∑ Derivative Lens ¬∑ GraphSensei">
      </div>

      <div class="row">
        <label>√ù t∆∞·ªüng s∆∞ ph·∫°m (v√¨ sao c√°ch n√†y hi·ªáu qu·∫£?)</label>
        <textarea id="pedagogy" placeholder="VD: li√™n k·∫øt thao t√°c tay‚Äìm·∫Øt v·ªõi kh√°i ni·ªám ƒë·∫°o h√†m; ph·∫£n h·ªìi t·ª©c th√¨ c·ªßng c·ªë m√¥ h√¨nh tinh th·∫ßn..."></textarea>
      </div>

      <div class="grid-2">
        <div class="row">
          <label>M√¥ t·∫£ UI (b·ªë c·ª•c th√†nh ph·∫ßn)</label>
          <textarea id="ui" placeholder="VD: tr√°i: panel tham s·ªë; ph·∫£i: canvas ƒëa l·ªõp; tr√™n: thanh c√¥ng c·ª•; d∆∞·ªõi: b·∫£ng bi·∫øn thi√™n."></textarea>
        </div>
        <div class="row">
          <label>Lu·ªìng UX (t·ª´ng b∆∞·ªõc HS kh√°m ph√°)</label>
          <textarea id="ux" placeholder="VD: B1 k√©o slider a; B2 quan s√°t ƒë·ªïi m√†u kho·∫£ng ƒë·ªìng/ngh·ªãch; B3 th·∫£ ƒëi·ªÉm xem y' v√† ti·∫øp tuy·∫øn..."></textarea>
        </div>
      </div>

      <div class="row">
        <label>Ghi ch√∫ th√™m (t√πy ch·ªçn)</label>
        <textarea id="note" placeholder="VD: y√™u c·∫ßu ch·∫°y t·ªët tr√™n m√°y chi·∫øu, c√≥ ch·∫ø ƒë·ªô n·ªÅn t·ªëi, h·ªó tr·ª£ mobile..."></textarea>
      </div>

      <div class="toolbar">
        <button class="btn btn-accent" id="btnExample">ƒêi·ªÅn nhanh v√≠ d·ª•</button>
        <button class="btn" id="btnClear">X√≥a form</button>
        <span class="stat" id="statMsg">ƒêang l∆∞u t·ª± ƒë·ªông‚Ä¶</span>
      </div>
    </section>

    <!-- RIGHT: PREVIEW -->
    <section class="preview" aria-label="Xem tr∆∞·ªõc Prompt">
      <div style="display:flex; align-items:center; justify-content:space-between; gap:8px; flex-wrap:wrap;">
        <h3>üîÆ Prompt ƒë√£ gh√©p</h3>
        <div>
          <span class="pill" id="pillWords">0 t·ª´</span>
          <span class="pill" id="pillQuality">Ch·ªù n·ªôi dung‚Ä¶</span>
        </div>
      </div>

      <div id="output" class="codebox" aria-live="polite"></div>

      <div class="bar">
        <button class="btn" id="btnCopy">Copy</button>
        <button class="btn" id="btnDownload">T·∫£i .txt</button>
        <button class="btn btn-ghost" id="btnCompact">Ch·∫ø ƒë·ªô g·ªçn <span id="cmpState">OFF</span></button>
      </div>
      <div class="hint" style="margin-top:8px">
        M·∫πo: Sau khi copy, c√≥ th·ªÉ d√°n th·∫≥ng v√†o ChatGPT/Gemini. Gi·ªØ <span class="kbd">Shift</span> khi nh·∫•n <b>Enter</b> ƒë·ªÉ xu·ªëng d√≤ng trong h·ªôp tho·∫°i AI.
      </div>
    </section>
  </main>

  <footer>
    T√°c gi·∫£: <b>Th·∫ßy V≈© Ti·∫øn L·ª±c</b> ‚Äî Tr∆∞·ªùng THPT Nguy·ªÖn H·ªØu C·∫£nh ¬∑ ¬© 2025 ¬∑ Made with ‚ù§Ô∏è for To√°n h·ªçc
  </footer>
</div>

<script>
(function(){
  const $ = sel => document.querySelector(sel);
  const els = {
    topic:   $('#topic'),
    audience:$('#audience'),
    goal:    $('#goal'),
    pain:    $('#pain'),
    ix1:     $('#ix1'),
    ix2:     $('#ix2'),
    viz:     $('#viz'),
    toolName:$('#toolName'),
    pedagogy:$('#pedagogy'),
    ui:      $('#ui'),
    ux:      $('#ux'),
    note:    $('#note'),
    output:  $('#output'),
    statMsg: $('#statMsg'),
    pillWords: $('#pillWords'),
    pillQuality: $('#pillQuality'),
    btnExample: $('#btnExample'),
    btnClear: $('#btnClear'),
    btnCopy: $('#btnCopy'),
    btnDownload: $('#btnDownload'),
    btnCompact: $('#btnCompact'),
    cmpState: $('#cmpState'),
  };
  const LS_KEY = 'prompt_lab_tool_v1';
  let compact = false;
  function save(){
    const data = {};
    Object.keys(els).forEach(k=>{
      if(els[k] instanceof HTMLInputElement || els[k] instanceof HTMLTextAreaElement || els[k] instanceof HTMLSelectElement){
        data[k] = els[k].value;
      }
    });
    localStorage.setItem(LS_KEY, JSON.stringify(data));
    els.statMsg.textContent = 'ƒê√£ l∆∞u ‚úî';
  }
  function load(){
    const raw = localStorage.getItem(LS_KEY);
    if(!raw) return;
    try{
      const data = JSON.parse(raw);
      Object.keys(data).forEach(k=>{
        if(els[k] && (els[k] instanceof HTMLInputElement || els[k] instanceof HTMLTextAreaElement || els[k] instanceof HTMLSelectElement)){
          els[k].value = data[k];
        }
      });
    }catch(e){}
  }
  function wordsCount(text){
    return (text.trim().match(/[\p{L}\p{N}‚Äô']+/gu)||[]).length;
  }
  function qualityBadge(len){
    if(len<40) return 'üîß Th√™m chi ti·∫øt';
    if(len<120) return '‚ú® Kh√° ·ªïn';
    return 'üöÄ R·∫•t ƒë·∫ßy ƒë·ªß';
  }
  function buildPrompt(){
    const topic = els.topic.value.trim();
    const audience = els.audience.value.trim() || 'H·ªçc sinh THPT';
    const goal = els.goal.value.trim();
    const pain = els.pain.value.trim();
    const ix1 = els.ix1.value.trim();
    const ix2 = els.ix2.value.trim();
    const viz = els.viz.value.trim();
    const toolName = els.toolName.value.trim();
    const pedagogy = els.pedagogy.value.trim();
    const ui = els.ui.value.trim();
    const ux = els.ux.value.trim();
    const note = els.note.value.trim();

    const vizBlock = viz ? viz :
`M√†n h√¨nh ch√≠nh: Hi·ªÉn th·ªã ƒë·ªìng th·ªùi ƒê·ªì th·ªã h√†m s·ªë (C), ƒë·ªì th·ªã c·ªßa ƒë·∫°o h√†m y', v√† b·∫£ng bi·∫øn thi√™n c·∫≠p nh·∫≠t theo th·ªùi gian th·ª±c.
ƒê√°nh d·∫•u m√†u s·∫Øc: T√¥ xanh c√°c kho·∫£ng ƒë·ªìng bi·∫øn, t√¥ ƒë·ªè c√°c kho·∫£ng ngh·ªãch bi·∫øn; ƒë√°nh d·∫•u r√µ c√°c ƒëi·ªÉm c·ª±c tr·ªã.`;

    const longForm =
`H√£y ƒë√≥ng vai m·ªôt Nh√† thi·∫øt k·∫ø tr·∫£i nghi·ªám h·ªçc t·∫≠p t∆∞∆°ng t√°c, chuy√™n gia v·ªÅ s∆∞ ph·∫°m To√°n h·ªçc.

Nhi·ªám v·ª• c·ªßa b·∫°n l√† ph√°c th·∫£o m·ªôt c√¥ng c·ª• h·ªçc t·∫≠p tr·ª±c quan cho ch·ªß ƒë·ªÅ: [${topic||'ƒêi·ªÅn ch·ªß ƒë·ªÅ to√°n h·ªçc c·ª• th·ªÉ'}].

C√¥ng c·ª• n√†y ph·∫£i ƒë√°p ·ª©ng c√°c y√™u c·∫ßu sau:

ƒê·ªëi t∆∞·ª£ng: ${audience}, gi√∫p c√°c em h·ªçc b√†i d·ªÖ hi·ªÉu v√† h·ª©ng th√∫ h∆°n.

M·ª•c ti√™u h·ªçc t·∫≠p c·ªët l√µi: Sau khi s·ª≠ d·ª•ng c√¥ng c·ª•, h·ªçc sinh ph·∫£i [${goal||'ƒêi·ªÅn m·ª•c ti√™u quan tr·ªçng nh·∫•t'}].

Gi·∫£i quy·∫øt kh√≥ khƒÉn: T·∫≠p trung gi·∫£i quy·∫øt v·∫•n ƒë·ªÅ l·ªõn nh·∫•t m√† h·ªçc sinh th∆∞·ªùng g·∫∑p v·ªõi ch·ªß ƒë·ªÅ n√†y, ƒë√≥ l√† [${pain||'ƒêi·ªÅn kh√≥ khƒÉn c·ªët l√µi'}].

T∆∞∆°ng t√°c ch√≠nh:
‚Ä¢ Cho ph√©p h·ªçc sinh [${ix1||'M√¥ t·∫£ t∆∞∆°ng t√°c 1'}].
‚Ä¢ Cho ph√©p h·ªçc sinh [${ix2||'M√¥ t·∫£ t∆∞∆°ng t√°c 2'}].

Tr·ª±c quan h√≥a:
${vizBlock}

K·∫øt qu·∫£ ƒë·∫ßu ra: Tr√¨nh b√†y √Ω t∆∞·ªüng d∆∞·ªõi d·∫°ng m·ªôt b·∫£n thi·∫øt k·∫ø chi ti·∫øt, bao g·ªìm:
‚Ä¢ T√™n g·ªçi c√¥ng c·ª•: ${toolName||'ƒê·∫∑t m·ªôt c√°i t√™n g·ª£i nh·ªõ v√† th√∫ v·ªã'}.
‚Ä¢ √ù t∆∞·ªüng s∆∞ ph·∫°m: ${pedagogy||'Gi·∫£i th√≠ch v√¨ sao c√°ch tr·ª±c quan h√≥a v√† t∆∞∆°ng t√°c n√†y hi·ªáu qu·∫£ cho vi·ªác h·ªçc'}.
‚Ä¢ M√¥ t·∫£ giao di·ªán ng∆∞·ªùi d√πng (UI): ${ui||'Ph√°c th·∫£o b·ªë c·ª•c c√°c th√†nh ph·∫ßn tr√™n m√†n h√¨nh'}.
‚Ä¢ Lu·ªìng tr·∫£i nghi·ªám ng∆∞·ªùi d√πng (UX): ${ux||'M√¥ t·∫£ t·ª´ng b∆∞·ªõc HS t∆∞∆°ng t√°c ƒë·ªÉ kh√°m ph√° ki·∫øn th·ª©c'}.
${note?('\nGhi ch√∫ th√™m: '+note):''}`;

    const compactForm =
`ƒê√ìNG VAI: Nh√† thi·∫øt k·∫ø tr·∫£i nghi·ªám h·ªçc t·∫≠p t∆∞∆°ng t√°c + Chuy√™n gia s∆∞ ph·∫°m To√°n.

CH·ª¶ ƒê·ªÄ: ${topic||'...'}
ƒê·ªêI T∆Ø·ª¢NG: ${audience}

M·ª§C TI√äU C·ªêT L√ïI: ${goal||'...'}
KH√ì KHƒÇN C·ªêT L√ïI: ${pain||'...'}

T∆Ø∆†NG T√ÅC:
- ${ix1||'...'}
- ${ix2||'...'}

TR·ª∞C QUAN:
${vizBlock}

XU·∫§T B·∫¢N THI·∫æT K·∫æ (b·∫Øt bu·ªôc):
- T√™n c√¥ng c·ª•: ${toolName||'...'}
- √ù t∆∞·ªüng s∆∞ ph·∫°m: ${pedagogy||'...'}
- UI: ${ui||'...'}
- UX: ${ux||'...'}${note?('\n- Ghi ch√∫: '+note):''}`;

    const out = compact ? compactForm : longForm;
    els.output.textContent = out;
    const wc = wordsCount(out);
    els.pillWords.textContent = wc + ' t·ª´';
    els.pillQuality.textContent = qualityBadge(wc);
    return out;
  }

  function fillExample(){
    els.topic.value = 'Kh·∫£o s√°t s·ª± bi·∫øn thi√™n v√† v·∫Ω ƒë·ªì th·ªã h√†m s·ªë b·∫≠c ba';
    els.goal.value  = "Hi·ªÉu m·ªëi li√™n h·ªá tr·ª±c quan gi·ªØa d·∫•u c·ªßa y' v·ªõi ƒë·ªìng/ngh·ªãch bi·∫øn v√† h√¨nh d·∫°ng ƒë·ªì th·ªã; nh·∫≠n bi·∫øt vai tr√≤ c·ªßa tham s·ªë a trong ƒë·ªô cong.";
    els.pain.value  = "Kh√¥ng h√¨nh dung ƒë∆∞·ª£c v√¨ sao ƒë·ªì th·ªã 'ƒëi l√™n/ƒëi xu·ªëng' v√† cong t·∫°i nh·ªØng v√πng c·ª• th·ªÉ; nh·∫ßm gi·ªØa c·ª±c tr·ªã v√† ƒëi·ªÉm u·ªën.";
    els.ix1.value   = "D√πng thanh tr∆∞·ª£t thay ƒë·ªïi a, b, c, d c·ªßa y = ax¬≥ + bx¬≤ + cx + d; t·ª± ƒë·ªông c·∫≠p nh·∫≠t ƒë·ªì th·ªã C, y', b·∫£ng bi·∫øn thi√™n.";
    els.ix2.value   = "K√©o m·ªôt ƒëi·ªÉm tr√™n C ƒë·ªÉ hi·ªán ti·∫øp tuy·∫øn, h·ªá s·ªë g√≥c = y'(x), ƒë√°nh d·∫•u m√†u kho·∫£ng ƒë·ªìng/ngh·ªãch bi·∫øn.";
    els.viz.value   = "";
    els.toolName.value = "Cubic Explorer";
    els.pedagogy.value = "Khai th√°c ph·∫£n h·ªìi t·ª©c th√¨ (immediate feedback) + li√™n k·∫øt thao t√°c/quan s√°t gi√∫p x√¢y d·ª±ng m√¥ h√¨nh tinh th·∫ßn v·ªÅ ƒë·∫°o h√†m. ƒê·ªìng b·ªô ƒë·ªì th·ªã‚Äìb·∫£ng bi·∫øn thi√™n gi·∫£m t·∫£i nh·∫≠n th·ª©c.";
    els.ui.value    = "Tr√°i: Panel h·ªá s·ªë (slider + input). Ph·∫£i: Canvas ƒë·ªì th·ªã ƒëa l·ªõp. Tr√™n: thanh c√¥ng c·ª• (Grid, Zoom, Reset). D∆∞·ªõi: B·∫£ng bi·∫øn thi√™n.";
    els.ux.value    = "B1 thay a‚Üí quan s√°t ƒë·ªïi m√†u ƒë·ªìng/ngh·ªãch; B2 k√©o ƒëi·ªÉm xem ti·∫øp tuy·∫øn; B3 so s√°nh v√πng y'>0/<0; B4 x√°c ƒë·ªãnh c·ª±c tr·ªã; B5 t·ªïng k·∫øt v√†o b·∫£ng bi·∫øn thi√™n.";
    els.note.value  = "C√≥ ch·∫ø ƒë·ªô Projector (n·ªÅn t·ªëi), responsive tr√™n ƒëi·ªán tho·∫°i, n√∫t xu·∫•t ·∫£nh minh h·ªça.";
  }

  // Attach listeners
  ['topic','audience','goal','pain','ix1','ix2','viz','toolName','pedagogy','ui','ux','note']
    .forEach(id=>{
      const el = els[id];
      el.addEventListener('input', ()=>{ buildPrompt(); save(); });
    });

  els.btnExample.addEventListener('click', ()=>{
    fillExample(); buildPrompt(); save();
  });

  els.btnClear.addEventListener('click', ()=>{
    if(confirm('X√≥a to√†n b·ªô n·ªôi dung form?')) {
      ['topic','goal','pain','ix1','ix2','viz','toolName','pedagogy','ui','ux','note'].forEach(id=>els[id].value='');
      els.audience.value='H·ªçc sinh THPT';
      buildPrompt(); save();
    }
  });

  els.btnCopy.addEventListener('click', async ()=>{
    const txt = buildPrompt();
    try{
      await navigator.clipboard.writeText(txt);
      els.statMsg.textContent = 'ƒê√£ copy v√†o clipboard ‚úÖ';
    }catch(e){
      els.statMsg.textContent = 'Kh√¥ng copy ƒë∆∞·ª£c, h√£y Ctrl/Cmd+C th·ªß c√¥ng.';
    }
  });

  els.btnDownload.addEventListener('click', ()=>{
    const blob = new Blob([buildPrompt()], {type:'text/plain;charset=utf-8'});
    const a = document.createElement('a');
    const name = (els.toolName.value.trim()||'prompt-cong-cu-truc-quan').replace(/\s+/g,'-').toLowerCase();
    a.href = URL.createObjectURL(blob);
    a.download = name + '.txt';
    document.body.appendChild(a); a.click(); a.remove();
    els.statMsg.textContent = 'ƒê√£ t·∫£i file .txt ‚¨áÔ∏è';
  });

  els.btnCompact.addEventListener('click', ()=>{
    compact = !compact;
    els.cmpState.textContent = compact ? 'ON' : 'OFF';
    buildPrompt();
  });

  // Init
  load(); buildPrompt();
})();
</script>
</body>
</html>
