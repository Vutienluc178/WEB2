<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <title>Kho CÃ´ng Cá»¥ ToÃ¡n há»c & GVCN â€“ Auto Menu</title>
  <link rel="stylesheet" href="css/styles.css">
</head>
<body>
<header class="topbar">
  <div class="brand">
    <div class="author">TÃ¡c giáº£ â€” <strong>Tháº§y VÅ© Tiáº¿n Lá»±c</strong> â€” TrÆ°á»ng <strong>THPT Nguyá»…n Há»¯u Cáº£nh</strong></div>
    <span class="logo">âˆ‘</span>
    <div>
      <h1>Kho CÃ´ng Cá»¥ ToÃ¡n há»c</h1>
      <p class="subtitle">Lá»›p 10 Â· 11 Â· 12 Â· GVCN Â· Tiá»‡n Ã­ch</p>
    </div>
  </div>
  <div class="actions">
    <button id="toggleTheme" class="btn" title="Chuyá»ƒn ná»n sÃ¡ng/tá»‘i">ğŸŒ“</button>
  </div>
</header>
<section class="filterbar">
  <label for="subcatFilter">Má»¥c con:</label>
  <select id="subcatFilter"><option value="">â€” Táº¥t cáº£ â€”</option></select>
</section>


<div class="layout">
  <!-- VÃ¹ng menu: sinh tá»± Ä‘á»™ng tá»« tools/index.json -->
  <nav class="sidebar">
    <h3>Danh má»¥c cÃ´ng cá»¥</h3>
    <div id="autoMenu">Äang táº£i menuâ€¦</div>
  </nav>

  <!-- Khung hiá»ƒn thá»‹ tool -->
  <main class="main">
    <div class="welcome card">
      <h2>ChÃ o má»«ng!</h2>
      <p>Chá»n cÃ´ng cá»¥ tá»« menu bÃªn trÃ¡i, hoáº·c má»Ÿ trá»±c tiáº¿p báº±ng query string <code>?tool=...</code>.</p>
    </div>

    <div class="viewer card">
      <div class="viewer-bar">
        <span id="viewerTitle">Xem nhanh</span>
        <a id="openNewTab" class="btn small" href="#" target="_blank" rel="noopener">Má»Ÿ tab má»›i â†—</a>
      </div>
      <iframe id="viewer" title="Xem nhanh cÃ´ng cá»¥" src="" loading="lazy"></iframe>
    </div>
  </main>
</div>

<footer class="footer">
  <small>Â© 2025 Â· TÃ¡c giáº£: Tháº§y VÅ© Tiáº¿n Lá»±c â€“ THPT Nguyá»…n Há»¯u Cáº£nh</small>
</footer>

<script src="js/app.js"></script>
<script>
// ========== Sinh menu tá»« tools/index.json ==========
(async function buildMenu(){
  const wrap = document.getElementById('autoMenu');
  try {
    const res = await fetch('tools/index.json', {cache:'no-store'});
    const groups = await res.json();
    wrap.innerHTML = '';

    groups.forEach((g, gi)=>{
      const det = document.createElement('details');
      det.className = 'acc';
      if(gi===0) det.open = true;

      const sum = document.createElement('summary');
      sum.textContent = g.group || 'NhÃ³m';
      det.appendChild(sum);

      const ul = document.createElement('ul');
      (g.items||[]).forEach(item=>{
        const li = document.createElement('li');
        const a  = document.createElement('a');
        a.textContent = item.title || item.path;
        a.href = 'tools/' + item.path.replace(/^tools\//,'');
        a.setAttribute('data-embed','');
        a.addEventListener('click', e=>{
          e.preventDefault();
          const url = a.getAttribute('href');
          const iframe = document.getElementById('viewer');
          const title  = document.getElementById('viewerTitle');
          const open   = document.getElementById('openNewTab');
          iframe.src = url;
          title.textContent = item.title || url;
          open.href = url;
        });
        li.appendChild(a);
        ul.appendChild(li);
      });
      det.appendChild(ul);
      wrap.appendChild(det);
    });
  } catch(err){
    wrap.textContent = 'âš ï¸ KhÃ´ng táº£i Ä‘Æ°á»£c menu (thiáº¿u tools/index.json)';
  }
})();
</script>
</body>
</html>
